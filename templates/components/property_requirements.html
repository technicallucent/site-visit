<!-- PROPERTY REQUIREMENTS SECTION -->
<div class="card mb-4">
    <div class="card-header bg-info text-white">
        <h5 class="card-title mb-0">Property Requirements</h5>
    </div>
    <div class="card-body">
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label">BHK Requirement</label>
                <select class="form-select" name="bhk_requirement">
                    <option value="">Select BHK requirement</option>
                    <option value="1BHK">1BHK</option>
                    <option value="2BHK">2BHK</option>
                    <option value="3BHK">3BHK</option>
                    <option value="4BHK">4BHK</option>
                    <option value="4+BHK">4+BHK</option>
                </select>
            </div>
            <div class="col-md-6">
                <label class="form-label">Budget</label>
                <select class="form-select" name="budget">
                    <option value="">Select Budget</option>
                    <option value="1 Cr to 2 Cr">1 Cr to 2 Cr</option>
                    <option value="2 Cr to 3 Cr">2 Cr to 3 Cr</option>
                    <option value="3 Cr to 5 Cr">3 Cr to 5 Cr</option>
                    <option value="5 Cr to 8 Cr">5 Cr to 8 Cr</option>
                    <option value="8 Cr to 12 Cr">8 Cr to 12 Cr</option>
                    <option value="12 Cr to 20 Cr">12 Cr to 20 Cr</option>
                    <option value="20 Cr to 30 Cr">20 Cr to 30 Cr</option>
                    <option value="30 Cr+">30 Cr+</option>
                </select>
            </div>
            <div class="col-md-6">
                <label class="form-label">Preferred Location</label>
                <select class="form-select select2-location" name="preferred_location" id="preferredLocation">
                    <option value="">Select preferred location</option>
                    <!-- Options will be loaded dynamically -->
                </select>
            </div>
            <div class="col-md-6">
                <label class="form-label">Preferred Projects</label>
                <select class="form-select select2" name="preferred_projects" multiple>
                    {% for project in projects %}
                        <option value="{{ project.id }}">{{ project.name }}</option>
                    {% endfor %}
                </select>
                <div class="form-text">You can select multiple projects</div>
            </div>
            <div class="col-12">
                <label class="form-label">Notes</label>
                <textarea class="form-control" name="notes" rows="3" 
                          placeholder="Enter any additional notes about client requirements"></textarea>
            </div>
        </div>
    </div>
</div>
<script>
    function loadLocations() {
    fetch('/api/locations')
        .then(response => response.json())
        .then(locations => {
            const preferredLocationSelect = document.getElementById('preferredLocation');
            const currentLocationSelect = document.getElementById('currentLocation');
            
            // Clear existing options except the first one
            clearSelectOptions(preferredLocationSelect);
            clearSelectOptions(currentLocationSelect);
            
            // Add location options
            locations.forEach(location => {
                const option1 = new Option(location.name, location.name);
                const option2 = new Option(location.name, location.name);
                preferredLocationSelect.add(option1);
                currentLocationSelect.add(option2);
            });
            
            // Initialize Select2 for location dropdowns
            $('.select2-location').select2({
                placeholder: "Select location",
                allowClear: true,
                width: '100%'
            });
        })
        .catch(error => {
            console.error('Error loading locations:', error);
        });
}

function clearSelectOptions(selectElement) {
    // Keep only the first option (placeholder)
    while (selectElement.options.length > 1) {
        selectElement.remove(1);
    }
}

// Load locations when the page loads
document.addEventListener('DOMContentLoaded', function() {
    loadLocations();
});

// Also load locations when client data section is shown
document.getElementById('verifyMobile').addEventListener('click', function() {
    // This will run after the verification, so locations will be loaded when needed
    setTimeout(loadLocations, 100);
});
</script>